# Sandboes: Quick and Dirty Approach
* A sandbox is a security mechanism for running untrusted programs in a safe environment without harming real system;
## Using a Malware Sandbox
* Most popular sandbox - Norman Sandbox, GFI Sandbox;
## Sandbox Drawbacks
* Sandbox runs the executables without command options;
* Sandbox cannot record all events;
* Malware often detects virtual environment;
* Some Malware often requires certain registry keys or files which is not in sandbox;
* If Malware is a DLL, certain exported functions will not invoked;
* Sandbox OS may not be correct for Malware;

# Running Malware
1. For DLL, command: rundll32.exe DLLname, Export arguments
    * Export arguments - a function name or ordinal number on Exported Function Table;
    * Examples: rundll32.exe rip.dll, Install / rundll32.exe rip.dll, #5
    * PEview or PE explorer to see Explorer Function Table;
2. Malicious DLL runs most of the code in DLLMain and DLLMain is executed whenever the DLL is loaded. Can get DLLMain run by forcing DLL to load using rundll32.exe;
3. Turn DLL into EXE:
    * Wipe IMAGE_FILE_DLL (0x2000) flags from Characteristics of IMAGE_FILE_HEADER;
    * Change extension to 'exe';
    * It will run the DLLMain but it will cause Malware to crash or terminate unexpectedly;
4. DLL malware may also need to be installed as a service, sometimes with an export such as InstallService:
    * Example: 
        * rundll32.exe ipr32x.dll, InstallService ServiceName
        * net start ServiceName - 'net start' = start a service on windows;
    * If there's no exported function (InstallService), may need manually install the service by using 'sc' command or modifying registry for an unused service. Then use 'net start' on that service.
        * Registry service entry - HKLM\SYSTEM\CurrentControlSet\Services.
    